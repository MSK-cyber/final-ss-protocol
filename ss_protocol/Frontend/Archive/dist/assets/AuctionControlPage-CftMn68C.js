import{u as v,r as i,j as e}from"./index-Fje8cVxI.js";function g(){const{AuctionContract:a,SwapLens:d}=v(),[n,m]=i.useState(!1),[r,x]=i.useState(""),[s,o]=i.useState({scheduled:!1,start:0,daysLimit:0,count:0}),h=async()=>{var c;if(a)try{if(d&&(a!=null&&a.target)){const l=await d.getScheduleConfig(a.target),[t,N,b,u]=l;o({scheduled:!!t,start:Number(N),daysLimit:Number(b),count:Number(u)})}else{const l=Number(await((c=a.tokenCount)==null?void 0:c.call(a).catch(()=>0)));o(t=>({...t,count:l}))}}catch(l){console.warn("Failed to load schedule",l)}};i.useEffect(()=>{h()},[a]);const j=async c=>{if(c.preventDefault(),!a)return alert("Auction contract not ready");let l;try{l=BigInt(Math.floor(r?new Date(r).getTime()/1e3:Date.now()/1e3))}catch{l=BigInt(Math.floor(Date.now()/1e3))}m(!0);try{const t=await a.startAuctionWithAutoTokens(l);alert(`Start auction tx: ${t.hash}`),await t.wait(),await h()}catch(t){alert(t.message||"Failed to start auction")}finally{m(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card mb-4",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h5",{className:"card-title mb-1",children:"üéØ AUCTION CONTROL"}),e.jsx("small",{className:"text-muted",children:"Step 5: Launch and monitor the auction system"})]}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:`alert ${s.scheduled?"alert-success":"alert-info"} d-flex align-items-center mb-4`,children:[e.jsx("div",{className:"me-3",style:{fontSize:"2rem"},children:s.scheduled?"üéâ":"üöÄ"}),e.jsx("div",{className:"flex-grow-1",children:s.scheduled?e.jsxs(e.Fragment,{children:[e.jsx("h6",{className:"alert-heading mb-1",children:"Auction System Active"}),e.jsxs("p",{className:"mb-0 small",children:["The auction schedule is running with ",s.count," registered token(s)."]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h6",{className:"alert-heading mb-1",children:"Ready to Launch"}),e.jsx("p",{className:"mb-0 small",children:"Start the auction system to begin token auctions."})]})})]}),e.jsx("div",{className:"card bg-primary bg-opacity-10 border-primary",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h6",{className:"mb-3",children:[e.jsx("i",{className:"bi bi-play-circle-fill me-2"}),"START AUCTION SYSTEM"]}),e.jsx("form",{onSubmit:j,children:e.jsxs("div",{className:"row g-3 align-items-end",children:[e.jsxs("div",{className:"col-md-8",children:[e.jsxs("label",{className:"form-label small fw-bold text-uppercase",children:[e.jsx("i",{className:"bi bi-calendar-event me-1"}),"Start Time (Optional)"]}),e.jsx("input",{type:"datetime-local",className:"form-control",value:r,onChange:c=>x(c.target.value)}),e.jsxs("small",{className:"text-muted d-block mt-1",children:[e.jsx("i",{className:"bi bi-info-circle me-1"}),"Leave empty to start immediately"]})]}),e.jsx("div",{className:"col-md-4",children:e.jsx("button",{className:"btn btn-primary w-100 btn-lg",type:"submit",disabled:n||!a,children:n?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2"}),"Starting..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-play-fill me-2"}),"Start Auction"]})})})]})})]})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"bi bi-graph-up me-2"}),"SYSTEM STATUS"]})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-6 col-lg-3",children:e.jsx("div",{className:`card h-100 ${s.scheduled?"border-success":"border-secondary"}`,style:{borderWidth:"2px"},children:e.jsxs("div",{className:"card-body text-center",children:[e.jsx("div",{style:{fontSize:"2rem"},className:"mb-2",children:s.scheduled?"‚úÖ":"‚è∏Ô∏è"}),e.jsx("h6",{className:"small fw-bold mb-1",children:"SCHEDULE STATUS"}),e.jsx("span",{className:`badge ${s.scheduled?"bg-success":"bg-secondary"}`,children:s.scheduled?"Active":"Inactive"})]})})}),e.jsx("div",{className:"col-md-6 col-lg-3",children:e.jsx("div",{className:"card h-100 border-primary",style:{borderWidth:"2px"},children:e.jsxs("div",{className:"card-body text-center",children:[e.jsx("div",{style:{fontSize:"2rem"},className:"mb-2",children:"üìÖ"}),e.jsx("h6",{className:"small fw-bold mb-1",children:"START TIME"}),e.jsx("p",{className:"small mb-0 text-muted",children:s.start?new Date(s.start*1e3).toLocaleDateString():"Not set"}),e.jsx("p",{className:"small mb-0 text-muted",children:s.start?new Date(s.start*1e3).toLocaleTimeString():"-"})]})})}),e.jsx("div",{className:"col-md-6 col-lg-3",children:e.jsx("div",{className:"card h-100 border-info",style:{borderWidth:"2px"},children:e.jsxs("div",{className:"card-body text-center",children:[e.jsx("div",{style:{fontSize:"2rem"},className:"mb-2",children:"üìä"}),e.jsx("h6",{className:"small fw-bold mb-1",children:"DAYS LIMIT"}),e.jsx("h4",{className:"mb-0 text-primary",children:s.daysLimit||"‚àû"}),e.jsx("small",{className:"text-muted",children:"Auction days"})]})})}),e.jsx("div",{className:"col-md-6 col-lg-3",children:e.jsx("div",{className:"card h-100 border-warning",style:{borderWidth:"2px"},children:e.jsxs("div",{className:"card-body text-center",children:[e.jsx("div",{style:{fontSize:"2rem"},className:"mb-2",children:"ü™ô"}),e.jsx("h6",{className:"small fw-bold mb-1",children:"TOKENS"}),e.jsx("h4",{className:"mb-0 text-primary",children:s.count}),e.jsx("small",{className:"text-muted",children:"Registered"})]})})})]})})]}),e.jsxs("div",{className:"card mt-4",children:[e.jsx("div",{className:"card-header bg-primary bg-opacity-10",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"bi bi-info-circle-fill me-2"}),"AUCTION SYSTEM INFORMATION"]})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"d-flex gap-3",children:[e.jsx("div",{className:"text-primary",style:{fontSize:"1.5rem"},children:"‚è∞"}),e.jsxs("div",{children:[e.jsx("h6",{className:"small fw-bold mb-1",children:"Auction Schedule"}),e.jsx("p",{className:"small text-muted mb-0",children:"Auctions run in 15-minute time slots. Each registered token gets a turn in the rotation."})]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"d-flex gap-3",children:[e.jsx("div",{className:"text-primary",style:{fontSize:"1.5rem"},children:"üîÑ"}),e.jsxs("div",{children:[e.jsx("h6",{className:"small fw-bold mb-1",children:"Reverse Auctions"}),e.jsx("p",{className:"small text-muted mb-0",children:"Every 4th appearance is a reverse auction where STATE is auctioned for the token."})]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"d-flex gap-3",children:[e.jsx("div",{className:"text-primary",style:{fontSize:"1.5rem"},children:"üéØ"}),e.jsxs("div",{children:[e.jsx("h6",{className:"small fw-bold mb-1",children:"Token Registration"}),e.jsx("p",{className:"small text-muted mb-0",children:"Tokens must be registered in Step 4 (Token Management) before starting the auction system."})]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"d-flex gap-3",children:[e.jsx("div",{className:"text-primary",style:{fontSize:"1.5rem"},children:"üìà"}),e.jsxs("div",{children:[e.jsx("h6",{className:"small fw-bold mb-1",children:"Automatic Execution"}),e.jsx("p",{className:"small text-muted mb-0",children:"Once started, auctions run automatically according to the schedule without manual intervention."})]})]})})]})})]})]})}export{g as default};
