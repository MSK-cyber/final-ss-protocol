import{ax as x,ay as g,az as i,a8 as f,a9 as p,aA as u,aB as d,aC as D,aD as b}from"./index-Fje8cVxI.js";function H(n){const{domain:t={},message:e,primaryType:a}=n,r={EIP712Domain:x({domain:t}),...n.types};g({domain:t,message:e,primaryType:a,types:r});const o=["0x1901"];return t&&o.push(P({domain:t,types:r})),a!=="EIP712Domain"&&o.push(y({data:e,primaryType:a,types:r})),i(f(o))}function P({domain:n,types:t}){return y({data:n,primaryType:"EIP712Domain",types:t})}function y({data:n,primaryType:t,types:e}){const a=h({data:n,primaryType:t,types:e});return i(a)}function h({data:n,primaryType:t,types:e}){const a=[{type:"bytes32"}],r=[l({primaryType:t,types:e})];for(const o of e[t]){const[s,c]=T({types:e,name:o.name,type:o.type,value:n[o.name]});a.push(s),r.push(c)}return p(a,r)}function l({primaryType:n,types:t}){const e=u($({primaryType:n,types:t}));return i(e)}function $({primaryType:n,types:t}){let e="";const a=m({primaryType:n,types:t});a.delete(n);const r=[n,...Array.from(a).sort()];for(const o of r)e+=`${o}(${t[o].map(({name:s,type:c})=>`${c} ${s}`).join(",")})`;return e}function m({primaryType:n,types:t},e=new Set){const a=n.match(/^\w*/u),r=a==null?void 0:a[0];if(e.has(r)||t[r]===void 0)return e;e.add(r);for(const o of t[r])m({primaryType:o.type,types:t},e);return e}function T({types:n,name:t,type:e,value:a}){if(n[e]!==void 0)return[{type:"bytes32"},i(h({data:a,primaryType:e,types:n}))];if(e==="bytes")return a=`0x${(a.length%2?"0":"")+a.slice(2)}`,[{type:"bytes32"},i(a)];if(e==="string")return[{type:"bytes32"},i(u(a))];if(e.lastIndexOf("]")===e.length-1){const r=e.slice(0,e.lastIndexOf("[")),o=a.map(s=>T({name:t,type:r,types:n,value:s}));return[{type:"bytes32"},i(p(o.map(([s])=>s),o.map(([,s])=>s)))]}return[{type:e},a]}const I=`Ethereum Signed Message:
`;function w(n){const t=typeof n=="string"?d(n):typeof n.raw=="string"?n.raw:D(n.raw),e=d(`${I}${b(t)}`);return f([e,t])}function M(n,t){return i(w(n),t)}export{H as a,M as h};
